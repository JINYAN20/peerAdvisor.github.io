<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Peer Assistant</title>
    <link rel="stylesheet" href="psyc_side.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo-container">
                <img src="images/logo_black.png" alt="Peer Assistant Logo"> 
                <span>Peer Assistant</span>
            </div>
            <div class="user">
                Hello Olivia
                <img src="/images/therapist.jpg" alt="Counselor">
            </div>
        </header>

        <!-- Main Content -->
        <div class="main">
            <!-- Sidebar -->
            <aside class="sidebar">
                <h3>My Clients</h3>
                <div class="clients">
                    <div class="client">
                        <img src="images/client1.png" class="profile-pic">
                        <div class="info">
                            <div class="name">Claudia Alves</div>
                            <div class="status">
                                <span class="assigned">Assigned: <span class="number">8</span></span>
                                <span class="completed">Completed: <span class="number">7</span></span>
                            </div>
                        </div>
                    </div>
                    <div class="client">
                        <img src="images/client2.png" class="profile-pic">
                        <div class="info">
                            <div class="name">Dani Martinez</div>
                            <div class="status">
                                <span class="assigned">Assigned: <span class="number">2</span></span>
                                <span class="completed">Completed: <span class="number">2</span></span>
                            </div>
                        </div>
                    </div>
                    <div class="client">
                        <img src="images/client3.png" class="profile-pic">
                        <div class="info">
                            <div class="name">Kimberly Nguyen</div>
                            <div class="status">
                                <span class="assigned">Assigned: <span class="number">7</span></span>
                                <span class="completed">Completed: <span class="number">0</span></span>
                            </div>
                        </div>
                    </div>
                </div>
                <button style="margin-top: 10px; padding: 10px">Add Client</button>
            </aside>

            <!-- Right Content -->
            <section class="content">
                <div class="client-info" id="client-info">
                    Select a client to see their details.
                </div>
                <div class="form-section">
                    <h2>Assign New Homework</h2>
                    <form>
                        <label for="name">Homework Title *</label>
                        <input type="text" id="name" name="name" required>

                        <label for="type">Type *</label>
                        <select id="type" name="type" required>
                            <option value="guilt">Guilt and Shame Treatment</option>
                        </select>

                        <label for="description">Description</label>
                        <textarea id="description" name="description" placeholder="Discribe the aim of this homework:"></textarea>

                        <label for="duedate">Due Date *</label>
                        <input type="date" id="duedate" name="duedate" required>

                        <label>Risky Words</label>
                        <div>
                            <label><input type="checkbox" name="risky" value="absolute"> Guarantees and Absolute Promises</label><br>
                            <label><input type="checkbox" name="risky" value="judgment"> Negative or Judgmental Terms</label>
                        </div>

                        <label>Tone</label>
                        <div>
                            <label><input type="checkbox" name="tone" value="supportive"> Empathetic</label><br>
                            <label><input type="checkbox" name="tone" value="friendly"> Conversational</label>
                        </div>

                        <label>Questions to Ask</label>
                        <textarea id="questions" name="questions" placeholder="Add more customized questions for chabot to ask:"></textarea>

                        <button type="submit" onclick="generateJSON()">Assign</button>
                    </form>
                </div>
            </section>
        </div>
    </div>
    <script>
        document.querySelectorAll('.client').forEach(client => {
            client.addEventListener('click', function() {
                // Get client information from the clicked element
                const profile = this.querySelector('.profile-pic').src;
                const name = this.querySelector('.name').textContent;
                
                // Update the client-info section
                const clientInfo = document.getElementById('client-info');
                clientInfo.innerHTML = `
                        <img src="${profile}" class="profile-pic">
                        <div class="client-info">
                            <div class="name">${name}</div>
                        </div>
                `;
                
                // Add active class to selected client and remove from others
                document.querySelectorAll('.client').forEach(c => c.classList.remove('active'));
                this.classList.add('active');
            });
        });

        function generateJSON() {
            event.preventDefault()
            // Collect form data
            const formData = {
                name: document.getElementById('name').value,
                type: document.getElementById('type').value,
                description: document.getElementById('description').value,
                duedate: document.getElementById('duedate').value,
                risky: document.querySelector('input[name="risky"]:checked')?.value,
                tone: document.querySelector('input[name="tone"]:checked')?.value,
                questions: document.getElementById('questions').value
            };

            fetch('http://127.0.0.1:5000/psyc_side', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(formData)
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                console.log("Response from Flask:", data);
                alert("Data uploaded successfully!");
            })
            .catch(error => {
                console.error("Error uploading data:", error);
                alert("Failed to upload data.");
            });       
        }
    </script>

</body>
</html>
